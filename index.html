<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="css/freecell_dom.css" />
    <link rel="stylesheet" type="text/css" href="css/tea.css" />
</head>
<body>
    <section class="cyp">
        <div class="row">
            <textarea id="m_a_message" class="column side"></textarea>
            <div class="column middle" style="background-color:#bbb;">
                <section class="pag">
                    <input type="password" id="m_word_a" />
                    <input type="password" id="m_word_b" />
                    <input type="number" id="m_start" />
                    <input type="number" id="m_end" />
                </section>
                <section class="tea">
                    <input type="password" id="m_key" />
                    <button id="m_a_process">&rarr;</button>
                    <button id="m_b_process">&larr;</button>
                </section>
            </div>
            <textarea id="m_b_message" class="column side"></textarea>
        </div>
    </section>
    <section id="m_game">
    </section>
    <button id="m_deal">Deal</button>
    <button id="m_auto" disabled>Auto</button>
    <button id="m_undo" disabled>Undo</button>
    <button id="m_redo" disabled>Redo</button>
    <ol id="m_history">History:</ol>

    <script src="js/utils.js"></script>
    <script src="js/cards.js"></script>
    <script src="js/freecell_audio.js"></script>
    <script src="js/freecell_basis.js"></script>
    <script src="js/freecell_manager.js"></script>
    <script src="js/freecell_game_dom.js"></script>

    <script>
        const freecell = createFreecellGame(8, 4, 4,
            {
                parent: m_game,
                deal: m_deal,
                auto: m_auto,
                undo: m_undo,
                redo: m_redo,
                history: m_history
            });
    </script>
    <script src="js/tea.min.js"></script>
    <script>
        m_a_process.onclick = function () {
            const key = m_key.value;
            if (key) {
                m_b_message.value = tea.ec(tea.ec(m_a_message.value, key), key.split("").reverse().join(""));
            }

        };

        m_b_process.onclick = function () {
            const key = m_key.value;
            if (key) {
                m_a_message.value = tea.dc(tea.dc(m_b_message.value, key.split("").reverse().join("")), key);
            }
        };
    </script>
    <script src="js/md5.min.js"></script>
    <script>
        m_start.oninput = m_end.oninput =
        m_word_a.onchange = m_word_b.onchange = function () {
            const i = +m_start.value || 0;
            const j = +m_end.value || 0;
            const wa = m_word_a.value || '';
            const wb = m_word_b.value || '';
            let b = btoa(md5(wa + '-' + wb + '\n'));

            if (i > 0 && j > i) {
                b = b.substring(i - 1, j);
            }
            m_key.value = b;
        };
    </script>
</body>
</html>
